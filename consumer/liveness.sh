#!/bin/bash

cd /opt/app

BROKER="kafka-broker-0-external.kafka-ns.svc.cluster.local"
PORT="9094"
TOPIC="push_cve_records"


# Fetch the latest offsets for the topic
output=$(bin/kafka-run-class.sh kafka.tools.GetOffsetShell \
    --broker-list $BROKER:$PORT --topic $TOPIC --time -1)

# Check if the command returned an error or empty output
if [[ -z "$output" ]]; then
    echo "Error: Failed to retrieve output...Exiting"
    exit 1
fi
